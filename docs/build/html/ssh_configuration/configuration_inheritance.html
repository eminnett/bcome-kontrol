

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configuration Inheritance &mdash; Bcome 1.3.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Overview" href="../usage/overview.html" />
    <link rel="prev" title="Bootstrapping" href="bootstrapping.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Bcome
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">What is Bcome?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../what/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../what/quick_look.html">A quick look</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../starting/installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Namespace Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../namespaces/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../namespaces/basic_configuration.html">Basic configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../namespaces/connecting_clouds.html">Connecting clouds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../namespaces/cleaning_up_server_names.html">Cleaning up server names</a></li>
<li class="toctree-l1"><a class="reference internal" href="../namespaces/caching_server_lookups.html">Caching server lookups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../namespaces/inventory_filtering.html">Inventory filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../namespaces/sub_selected_inventories.html">Sub-selected inventories</a></li>
</ul>
<p class="caption"><span class="caption-text">SSH configuration</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="direct_connections.html">Direct connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxied_connections.html">Proxied connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="bootstrapping.html">Bootstrapping</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration Inheritance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-inheritance-works">How inheritance works</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overriding-configuration-settings-on-a-per-server-basis">Overriding configuration settings on a per server basis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-machine-data-yml">The machine-data.yml</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/navigation.html">Navigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/commands.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/caching_inventories.html">Caching Inventories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/testing_connections.html">Testing connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/ssh_to_a_server.html">SSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/executing_commands.html">Executing commands with run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/pseudo_tty.html">Pseudo tty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/file_transfers.html">File transfers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/interactive_mode.html">Interactive Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/bootstrapping_mode.html">Bootstrapping mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/port_forwarding.html">Port Forwarding</a></li>
</ul>
<p class="caption"><span class="caption-text">Basic Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripting/bash_scripting.html">Bash scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripting/ruby_scripting.html">Basic ruby scripting</a></li>
</ul>
<p class="caption"><span class="caption-text">Orchestration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../orchestration/registry.html">The Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orchestration/metadata_framework.html">The metadata framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orchestration/internal_hooks.html">Internal Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orchestration/external_hooks.html">External Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orchestration/tags.html">Tags</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bcome</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Configuration Inheritance</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ssh_configuration/configuration_inheritance.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuration-inheritance">
<h1>Configuration Inheritance<a class="headerlink" href="#configuration-inheritance" title="Permalink to this headline">¶</a></h1>
<div class="section" id="how-inheritance-works">
<h2>How inheritance works<a class="headerlink" href="#how-inheritance-works" title="Permalink to this headline">¶</a></h2>
<p>Just like the network namespace configuration, SSH configuration is inherited down your namespaces. Lower namespaces are then free to override or define as new the configuration you require.</p>
<p>Take two inventories, the first representing your production servers, and the second, staging. You could define the common aspects of your ssh configuration on the parent collection, which is then inherited by both inventories, and then define different proxy rules on each inventory.</p>
<p>For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">:estate</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">:description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Top level collection</span>
  <span class="l l-Scalar l-Scalar-Plain">:type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">collection</span>

<span class=" -Error"> </span><span class="l l-Scalar l-Scalar-Plain">:network</span><span class="p p-Indicator">:</span>
   <span class="l l-Scalar l-Scalar-Plain">:type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
   <span class="l l-Scalar l-Scalar-Plain">:credentials_key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">awsreferencekey</span>
   <span class="l l-Scalar l-Scalar-Plain">:provisioning_region</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">us-east-1</span>

   <span class="l l-Scalar l-Scalar-Plain">:ssh_settings</span><span class="p p-Indicator">:</span>
     <span class="l l-Scalar l-Scalar-Plain">:ssh_keys</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;~/.ssh/id_rsa&quot;</span>
     <span class="l l-Scalar l-Scalar-Plain">:timeout_in_seconds</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="l l-Scalar l-Scalar-Plain">:estate:staging</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">:description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">My staging inventory</span>
  <span class="l l-Scalar l-Scalar-Plain">:type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">inventory</span>

  <span class="l l-Scalar l-Scalar-Plain">:ec2_filters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:tag:stage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">staging</span>

  <span class="l l-Scalar l-Scalar-Plain">:ssh_settings</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:proxy</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">:host_lookup</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">by_host_or_ip</span>
      <span class="l l-Scalar l-Scalar-Plain">:host_id</span><span class="p p-Indicator">:</span> <span class="s">&quot;111.111.111.11&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">:estate:production</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">:description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">My production inventory</span>
  <span class="l l-Scalar l-Scalar-Plain">:type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">inventory</span>

  <span class="l l-Scalar l-Scalar-Plain">:ec2_filters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:tag:stage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">production</span>

  <span class="l l-Scalar l-Scalar-Plain">:ssh_settings</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:proxy</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">:host_lookup</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">by_host_or_ip</span>
      <span class="l l-Scalar l-Scalar-Plain">:host_id</span><span class="p p-Indicator">:</span> <span class="s">&quot;222.222.222.22&quot;</span>
</pre></div>
</div>
<p>You’re free to override the ssh_settings as you see fit to support whichever connection scheme you have setup. For example, you may mix and match Direct Connections or Proxied Connections.</p>
<p>Let’s consider a second use case: Two inventories, production and staging, where only production requires proxied access to your hosts:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">:estate</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">:description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Top level collection</span>
  <span class="l l-Scalar l-Scalar-Plain">:type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">collection</span>

<span class=" -Error"> </span><span class="l l-Scalar l-Scalar-Plain">:network</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">:credentials_key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">awsreferencekey</span>
    <span class="l l-Scalar l-Scalar-Plain">:provisioning_region</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">us-east-1</span>

 <span class=" -Error"> </span><span class="l l-Scalar l-Scalar-Plain">:ssh_settings</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:ssh_keys</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;~/.ssh/id_rsa&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">:timeout_in_seconds</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="l l-Scalar l-Scalar-Plain">:estate:staging</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">:description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">My staging inventory</span>
  <span class="l l-Scalar l-Scalar-Plain">:type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">inventory</span>

  <span class="l l-Scalar l-Scalar-Plain">:ec2_filters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:tag:stage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">staging</span>


<span class="l l-Scalar l-Scalar-Plain">:estate:production</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">:description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">My production inventory</span>
  <span class="l l-Scalar l-Scalar-Plain">:type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">inventory</span>

  <span class="l l-Scalar l-Scalar-Plain">:ec2_filters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:tag:stage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">production</span>

  <span class="l l-Scalar l-Scalar-Plain">:ssh_settings</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:proxy</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">:host_lookup</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">by_host_or_ip</span>
      <span class="l l-Scalar l-Scalar-Plain">:host_id</span><span class="p p-Indicator">:</span> <span class="s">&quot;xx.xxx.xxx.xxx&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="overriding-configuration-settings-on-a-per-server-basis">
<h2>Overriding configuration settings on a per server basis<a class="headerlink" href="#overriding-configuration-settings-on-a-per-server-basis" title="Permalink to this headline">¶</a></h2>
<p>While by default all your servers will inherit any configuration specified by their parent namespace (as defined in your networks.yml configuration file), it’s sometimes useful to override configuration on a per-server basis.</p>
<p>For example, you may have a server deployed within your network that requires different SSH connection parameters. Let’s assume that your networks.yml configuration defines your bootstrap SSH user as ‘ubuntu’ whilst for the server in question, the boostrap ssh user needs to be ‘admin’. How would we achieve this?</p>
<p>Let’s assume your server is identified by namespace :estate:production:debianserver</p>
<div class="section" id="the-machine-data-yml">
<h3>The machine-data.yml<a class="headerlink" href="#the-machine-data-yml" title="Permalink to this headline">¶</a></h3>
<p>Within your bcome config directory, create a file as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bcome/machines-data.yml
</pre></div>
</div>
<p>Within your machines-data config, add the following:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">:estate:production:debianserver</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">:ssh_settings</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">:bootstrap_settings</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">:user</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">admin</span>
</pre></div>
</div>
<p>The bootstrapped SSH user for estate:production:debianserver is now overriden.</p>
<p>You may override any configuration for your servers (or indeed, set any new configuration) using this method.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../usage/overview.html" class="btn btn-neutral float-right" title="Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="bootstrapping.html" class="btn btn-neutral" title="Bootstrapping" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, webzakimbo

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>